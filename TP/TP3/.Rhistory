names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
knitr::opts_chunk$set(echo = TRUE)
library(colorspace) # get nice colors
species_col <- rev(rainbow_hcl(3))[as.numeric(species_labels)]
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
knitr::opts_chunk$set(echo = TRUE)
library(colorspace) # get nice colors
species_col <- rev(rainbow_hcl(3))[as.numeric(species_labels)]
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
kmeans.result = kmeans(iris[,-5],3)
names(kmeans.result)
table(iris$Species,kmeans.result$cluster)
plot(Sepal.Length,Sepal.Width)
library(ape)
library(cluster)
hc <- hclust(dist(iris[,-5]),method = "ward.D2")
plot(hc,hang = -1,labels = iris$Species)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
table(iris$Species,groups)
barplot(hc$height)
d_iris <- dist(iris2) # method="man" # is a bit better
data = read.table("fromage.txt",header = TRUE,row.names = 1)
head(data)
hc <- hclust(dist(data),method = "ward.D2")
hc2 <- hclust(dist(scale(data)),method = "ward.D2")
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data))
plot(hc2,hang = -1,labels = rownames(data))
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
for (i in range(0,3)) Means_groups[i,]<-colMeans(groups[i]);
groups
groups$1
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
for (i in range(0,3)) Means_groups[i,]<-colMeans(data[which(groups=i),]);
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
for (i in range(0,K)) Means_groups[i,]<-colMeans(data[which(groups==i),]);
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
Means_groups <- matrix(NA,nrow = K,ncol = dim(data)[2])
for (i in range(0,K)) Means_groups[i,]<-colMeans(data[which(groups==i),]);
Means_groups
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
Means_groups <- matrix(NA,nrow = K,ncol = dim(data)[2])
colnames(Means_groups) = colnames(data)
for (i in range(0,K)) Means_groups[i,]<-colMeans(data[which(groups==i),]);
for (i in range(0,K)) Means_groups[i,]<-colMeans(data[which(groups==i),]);
Means_groups
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
Means_groups <- matrix(NA,nrow = K,ncol = dim(data)[2])
colnames(Means_groups) = colnames(data)
for (i in K) Means_groups[i,]<-colMeans(data[which(groups==i),]);
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
Means_groups <- matrix(NA,nrow = K,ncol = dim(data)[2])
colnames(Means_groups) = colnames(data)
for (i in K) Means_groups[i,]<-colMeans(data[which(groups==i),]);
Means_groups
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = names[1])
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
Means_groups <- matrix(NA,nrow = K,ncol = dim(data)[2])
colnames(Means_groups) = colnames(data)
for (i in 1:K) Means_groups[i,]<-colMeans(data[which(groups==i),]);
Means_groups
names =c("ward.D", "single", "complete", "average", "mcquitty", "median", "centroid")
for( i in names){
hc <- hclust(dist(scale(data)),method = i)
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=3)
groups <-cutree(hc,k=3)
valu = barplot(hc$height)
}
K = 5
hc <- hclust(dist(scale(data)),method = "ward.D2")
par(mfrow=c(1,2))
plot(hc,hang = -1,labels = rownames(data),main=i)
rect.hclust(hc,k=K)
groups <-cutree(hc,k=K)
valu = barplot(hc$height)
Means_groups <- matrix(NA,nrow = K,ncol = dim(data)[2])
colnames(Means_groups) = colnames(data)
for (i in 1:K) Means_groups[i,]<-colMeans(data[which(groups==i),]);
Means_groups
kmeans.result = kmeans(data,5)
names(kmeans.result)
kmeans.result
kmeans.result = kmeans(data,5)
names(kmeans.result)
kmeans.result
kmeans.result = kmeans(data,5)
kmeans.result
kmeans.result = kmeans(data,centers = Means_groups)
kmeans.result = kmeans(data,centers = Means_groups)
kmeans.result
kmeans.result2$withinss
kmeans.result2 = kmeans(data,centers = Means_groups)
kmeans.result2
kmeans.result2$withinss
kmeans.result2$tot.withinss
kmeans.result2$betweenss
kmeans.result2$totss
kmeans.result3=kmeans(data,5,iter.max = 5, nstart=100)
kmeans.result3$cluster
kmeans.result2$withinss
kmeans.result2$tot.withinss
kmeans.result2$betweenss
kmeans.result2$totss
kmeans.result3=kmeans(data,5,iter.max = 5, nstart=100)
kmeans.result3$cluster
data2=scale(data)
inertie.intra<- rep(0,time=10)
for(k in 1:10){
kmeans.result <- kmeans(data2,centers=K,nstart = 100)
inertie.intra[k]<-kmeans.result$tot.withinss/kmeans.result$totss
}
#graphique
plot(1:10,inertie.intra,type='b',xlab='Nb de groupes',ylab = '% inertie intra')
data2
data2=(data)
inertie.intra<- rep(0,time=10)
for(k in 1:10){
kmeans.result <- kmeans(data2,centers=K,nstart = 100)
inertie.intra[k]<-kmeans.result$tot.withinss/kmeans.result$totss
}
#graphique
plot(1:10,inertie.intra,type='b',xlab='Nb de groupes',ylab = '% inertie intra')
data2=scale(data)
inertie.intra<- rep(0,time=10)
for(k in 1:10){
kmeans.result <- kmeans(data2,centers=K,nstart = 100)
inertie.intra[k]<-kmeans.result$tot.withinss/kmeans.result$totss
}
#graphique
plot(1:10,inertie.intra,type='b',xlab='Nb de groupes',ylab = '% inertie intra')
data2=scale(data)
inertie.intra<- rep(0,time=10)
for(k in 1:10){
kmeans.result <- kmeans(data2,centers=k,nstart = 100)
inertie.intra[k]<-kmeans.result$tot.withinss/kmeans.result$totss
}
#graphique
plot(1:10,inertie.intra,type='b',xlab='Nb de groupes',ylab = '% inertie intra')
pairs(inertie.intra)
pairs(data)
